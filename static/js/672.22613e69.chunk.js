"use strict";(self.webpackChunkspirify=self.webpackChunkspirify||[]).push([[672],{46257:function(t,n,e){e.r(n),e.d(n,{default:function(){return T}});var i=e(29439),a=e(72791),r=e(80177),l=e(93433),o=e(13534),s=e.n(o),c=e(9323),d=e.n(c),u=e(61293),p=e.n(u),v=e(15125),h=(e(27862),e(66106)),g=e(30914),m=e(81747);function f(t){var n=m.ZP.load("<body></body>"),e=n("body");return t.forEach((function(t){if("name"in t){var i=n("<".concat(t.name,">"));for(var a in t.attribs)i.attr(a,t.attribs[a]);t.children&&i.append(f(t.children)),e.append(i)}else"data"in t&&e.append(t.data)})),n.html()}var b=e(1413),x=e(21765),y=e(30298),z=e.n(y),S=e(26769),k=e.n(S);function _(t){var n=function(t){var n,e={};return null!==(n=t.attribs)&&void 0!==n&&n.style&&(e=t.attribs.style.split(";").reduce((function(t,n){var e=n.split(":").map((function(t){return t.trim()})),a=(0,i.Z)(e,2),r=a[0],l=a[1];return r&&(t[r]=l),t}),{})),e}(t);n["list-style-type"]="none",n["padding-left"]="0",t.attribs||(t.attribs={}),t.attribs.style=function(t){return Object.entries(t).map((function(t){var n=(0,i.Z)(t,2),e=n[0],a=n[1];return"".concat(e,": ").concat(a)})).join("; ")}(n)}function j(t,n,e){var i,a,r,l,o,s,c=(null===(i=t.attribs)||void 0===i?void 0:i.icon)||n.icon||e.icon,d=(null===(a=t.attribs)||void 0===a?void 0:a.size)||n.iconSize||e.iconSize,u=(null===(r=t.attribs)||void 0===r?void 0:r.class)||n.className||e.className;null!==(l=t.attribs)&&void 0!==l&&l.icon&&delete t.attribs.icon,null!==(o=t.attribs)&&void 0!==o&&o.size&&delete t.attribs.size,null!==(s=t.attribs)&&void 0!==s&&s.class&&delete t.attribs.class;var p,v=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"25px";z()(t)?t="".concat(t,"px"):k()(t)&&/^\d+px$/.test(t)||(t="25px");var n=16+.64*(Number(t.slice(0,-2))-25);return n=Math.max(n,16),{fontSize:"".concat(n,"px"),imageSize:t,squareSize:t}}(d),h=function(t,n,e,i){var a=new x.EmojiConvertor;a.replace_mode="unified",a.allow_native=!0;var r,l=":".concat(n,":"),o=a.replace_colons(l),s=o!==l,c=!s&&(/^(\.\/)?[a-zA-Z0-9\-._~:/?#[\]@!$&'()*+,;=%]+\.(jpg|png|gif|bmp|svg|jpeg)$/.test(n)||/^(http(s)?|ftp):\/\/[^\s/$.?#].[^\s]*$/.test(n)),d="width: ".concat(e.squareSize,"; height: ").concat(e.squareSize,"; \n          margin-right:5px;text-align:center;display:flex;align-items:center;");if(s)r={type:"tag",name:"span",attribs:(0,b.Z)((0,b.Z)({},i&&{class:i}),{},{"aria-hidden":"true",style:"".concat(d).concat(e.fontSize?"font-size:".concat(e.fontSize,";\n        margin-right: 5px;"):"margin-right: 5px;")}),children:[{type:"text",data:o}],next:void 0,prev:void 0,parent:t};else if(c){var u,p,v=(null===(u=n.split("/").pop())||void 0===u?void 0:u.split(".")[0])||"",h={type:"tag",name:"div",attribs:{style:"padding-bottom: 0.2rem;"},children:[],next:void 0,prev:void 0,parent:t},g={type:"tag",name:"img",attribs:(0,b.Z)((0,b.Z)({},i&&{class:i}),{},{src:n,alt:v,style:d}),children:[],next:void 0,prev:void 0,parent:h};null===(p=h.children)||void 0===p||p.push(g),r=h}else r={type:"tag",name:"i",attribs:{class:i?"".concat(n," ").concat(i):n,"aria-hidden":"true",style:"".concat(d,"margin-right:5px;").concat(e.fontSize?"font-size:".concat(e.fontSize,";"):"")},children:[],next:void 0,prev:void 0,parent:t};return r}(t,c,v,u),g=(p=t,{type:"tag",name:"div",attribs:{},children:t.children||[],next:void 0,prev:void 0,parent:p});t.children=[h,g],function(t,n,e){t.next=n,n.prev=t,e.forEach((function(t){t.parent=n}))}(h,g,t.children||[]),t.attribs||(t.attribs={}),t.attribs.style="display: flex;"}var w=e(80184),Z=new(s());Z.use(d()),Z.core.ruler.push("modify_tokens",(function(t){var n=[],e=[];t.tokens.forEach((function(t,i){if("bullet_list_open"===t.type)n.push({index:i,map:(0,l.Z)(t.map),token:t,pTag:!1,atIndex:-1});else if("bullet_list_close"===t.type){var a=n.pop();null!=a&&(null!==a.token.attrs?(a.map[0]=a.map[0]+1,n.length>0?n[n.length-1].map[0]=a.map[0]+1:a.map[0]=a.map[0]+1):n.length>0&&(n[n.length-1].map[0]=a.map[0]),e.push(a))}else"inline"===t.type&&n.length>0&&(n[n.length-1].map[0]>=t.map[0]||(n[n.length-1].pTag=!0,n[n.length-1].atIndex=i),n[n.length-1].map[0]=t.map[1])}));var i=[];t.tokens.forEach((function(t,n){if("paragraph_open"===t.type||"paragraph_close"===t.type){var a=e.find((function(n){return n.token.level===t.level-2}));a?a.pTag&&i.push(t):i.push(t)}else i.push(t)})),t.tokens=i}));var N=function(t){var n=t.markdown,e=Z.render(n);console.log("renderedMarkdown",e);var i,a=(i=e,m.ZP.parseHTML(i));console.log(a),null===a?console.log("parseHTML(renderedMarkdown) returned null"):a.forEach((function(t){"ul"==t.name&&(console.log("ul node",t),function(t){var n,e,i=null===(n=t.attribs)||void 0===n?void 0:n.icon,a=null===(e=t.children)||void 0===e?void 0:e.find((function(t){var n;return"li"===t.name&&(null===(n=t.attribs)||void 0===n?void 0:n.icon)}));if(void 0===i&&void 0===a)return t;if("name"in t&&"ul"===t.name){var r,l,o,s,c,d={icon:i,iconSize:null===(r=t.attribs)||void 0===r?void 0:r.size,className:null===(l=t.attribs)||void 0===l?void 0:l.class};d.icon&&(null===(o=t.attribs)||void 0===o||delete o.icon),d.iconSize&&(null===(s=t.attribs)||void 0===s||delete s.size),d.className&&(null===(c=t.attribs)||void 0===c||delete c.class);var u,p,v,h,g={};a&&(g={icon:null===(u=a.attribs)||void 0===u?void 0:u.icon,iconSize:null===(p=a.attribs)||void 0===p?void 0:p.size,className:null===(v=a.attribs)||void 0===v?void 0:v.class}),(d.icon||a)&&(_(t),t.children=(null===(h=t.children)||void 0===h?void 0:h.map((function(t){return"li"===t.name&&j(t,d,g),t})))||[])}}(t),t=function(t){if("name"in t&&"ul"===t.name&&t.attribs&&void 0!==t.attribs.bargraph){var n,e,i,a=50*((null===(n=t.children)||void 0===n?void 0:n.length)||0),r=0,l=[];null===(e=t.children)||void 0===e||e.forEach((function(t){if("name"in t&&"li"===t.name&&t.attribs&&t.attribs.value){var n=3*Number(t.attribs.value);n>r&&(r=n)}})),null===(i=t.children)||void 0===i||i.forEach((function(n,e){if("name"in n&&"li"===n.name&&n.attribs&&n.attribs.value){var i=3*Number(n.attribs.value),a=50*e,o=r-i+20,s={type:"tag",name:"rect",attribs:{x:a.toString(),y:o.toString(),width:40..toString(),height:i.toString(),fill:"red"},children:[],parent:t,prev:e>0?l[l.length-1]:void 0,next:void 0};if(e>0&&l[l.length-1]&&"next"in l[l.length-1]&&(l[l.length-1].next=s),l.push(s),"children"in n&&n.children&&n.children.length>0&&"data"in n.children[0]){var c={type:"tag",name:"text",attribs:{x:a.toString(),y:(20+r+20).toString(),fill:"black"},children:[{type:"text",data:n.children[0].data}],parent:t,prev:l[l.length-1],next:void 0};"next"in s&&(s.next=c),l.push(c)}}})),t.attribs={width:a.toString(),height:(40+r+30).toString()},t.name="svg",t.children=l}return t}(t),console.log("after process",t),e=f([t]))}));var r=(0,v.html)(e,{indent_size:2}),l=p().highlight(r,p().languages.markup,"markup");return(0,w.jsx)("div",{children:(0,w.jsxs)(h.Z,{gutter:[16,16],children:[(0,w.jsx)(g.Z,{span:12,children:(0,w.jsx)("div",{dangerouslySetInnerHTML:{__html:e}})}),(0,w.jsx)(g.Z,{span:12,children:(0,w.jsx)("pre",{className:"language-markup",children:(0,w.jsx)("code",{dangerouslySetInnerHTML:{__html:l}})})})]})})},E=r.Z.TextArea,T=function(){var t=(0,a.useState)('\n- item 1\n- item 2 {icon="https://spirify.azurewebsites.net/icon-512.png"}\n'),n=(0,i.Z)(t,2),e=n[0],r=n[1];return(0,w.jsxs)("div",{children:[(0,w.jsx)(E,{value:e,onChange:function(t){return r(t.target.value)},placeholder:"Write some markdown here...",rows:4}),(0,w.jsx)(N,{markdown:e})]})}}}]);
//# sourceMappingURL=672.22613e69.chunk.js.map